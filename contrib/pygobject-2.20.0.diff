	* Fixes build with --disable-thread
	Submitted at: http://bugzilla.gnome.org/show_bug.cgi?id=374603

--- gobject/pygobject-private.h.orig	Wed May 13 23:56:45 2009
+++ gobject/pygobject-private.h	Tue Jul 21 09:02:57 2009
@@ -32,12 +32,18 @@ extern struct _PyGObject_Functions pygob
 
 #define pyg_threads_enabled (pygobject_api_functions.threads_enabled)
 
+#ifdef DISABLE_THREADING
+#define pyg_gil_state_ensure() 0
+#define pyg_gil_state_release(state) G_STMT_START {     \
+    } G_STMT_END
 
+#else
 #define pyg_gil_state_ensure() (pygobject_api_functions.threads_enabled? (PyGILState_Ensure()) : 0)
 #define pyg_gil_state_release(state) G_STMT_START {     \
     if (pygobject_api_functions.threads_enabled)        \
         PyGILState_Release(state);                      \
     } G_STMT_END
+#endif
 
 #define pyg_begin_allow_threads                         \
     G_STMT_START {                                      \
--- glib/pyglib.h.old	2009-06-17 22:48:38.000000000 +0200
+++ glib/pyglib.h	2010-01-28 11:03:09.000000000 +0100
@@ -28,6 +28,9 @@
 
 G_BEGIN_DECLS
 
+#define PyGILState_Ensure() 0
+#define PyGILState_Release(x) do {} while (0)
+
 typedef void (*PyGLibThreadsEnabledFunc) (void);
 typedef void (*PyGLibThreadBlockFunc) (void);
 
--- gobject/pygobject.h.old	2010-01-29 08:28:30.000000000 +0100
+++ gobject/pygobject.h	2010-01-29 08:28:53.000000000 +0100
@@ -9,6 +9,9 @@
 
 G_BEGIN_DECLS
 
+#define PyGILState_Ensure() 0
+#define PyGILState_Release(x) do {} while (0)
+
 /* This is deprecated, don't use */
 #define PYGIL_API_IS_BUGGY FALSE
 
